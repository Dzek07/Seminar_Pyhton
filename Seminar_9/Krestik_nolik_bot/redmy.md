# Телеграмм бот крестики нолики

## Логика работы ##

### Используемые модули ###

telebot и random

В API_TOKEN кладем токен от бота <br/>
В переменную bot кладем выполнение подключения к боту <br/>
board присваеваем пустой список <br/>
@bot.message_handler(commands=['start']) - Ждем команду start <br/>

+ def start_message(message):
    + global board
    + board = list(range(1,10))
    + for i in range(3):
        + bot.send_message(message.chat.id, (f'| {board[0+i*3]} | {board[1+i*3]} | {board[2+i*3]} |'))<br/>

После получения команды start эта функция заполняет массив board элементами от 1 до 9 и выводит доску тремя сообщениями<br/>
![pic1](start.jpg)

@bot.message_handler(commands=['hod']) - Ждем команду hod  и через пробел число куда поставим крестик<br/>
+ def hod_message(message):
    + prov = 0 *- Переменная для проверки не упали ли в ошибку*
    + win = 0 *- Переменная для проверки не закнчилась ли игра*
    + global board *- board делаем глобальной чтобы работала эта функция с этим списком*<br/>

    + while True:
        + player_answer = message.text.split()[1:]
        + prov = 0
            + if player_answer[0].isdigit() == True:
                + pl = int(player_answer[0])
                + if pl >= 1 and pl <= 9:
                    + if(str(board[pl-1]) not in "XO"):
                        + board[pl-1] = 'X'
                        + break
                    + else:
                        + bot.send_message(message.chat.id,"Эта клетка уже занята! Введите команду заново")
                        + prov = 1
                        + break
                + else:
                    + bot.send_message(message.chat.id,"Некорректный ввод. Введите число от 1 до 9. Введите команду заново")
                    + prov = 1
                    + break
            + else:
                + bot.send_message(message.chat.id,"Некорректный ввод. Введите число от 1 до 9. Введите команду заново")
                + prov = 1
                + break<br/>

В этом цикле забираем то что ввел пользовотель и кладем в переменную pl. Далее проверяем попали ли мы в диапазон доски и не занято ли это поле. Если все правельно ход делается и цикл прирывается. Иначе происходит проверка сообщения пользавателя и выводится соответствующие сообщение в переменную prov кладем 1 и цикл прерывается

+ for i in range(3):
    + bot.send_message(message.chat.id, (f'| {board[0+i*3]} | {board[1+i*3]} | {board[2+i*3]} |'))

После хода выводится доска

+ win_coord = ((0,1,2), (3,4,5), (6,7,8), (0,3,6), (1,4,7), (2,5,8), (0,4,8), (2,4,6))
    + for each in win_coord:
        + if board[each[0]] == board[each[1]] == board[each[2]]:
          + bot.send_message(message.chat.id,"Игра закончилась, победил игрок")
          + win = 1

Проверяем не закончилась ли игра. Если условия не выполнились программа продолжет дальше работать. А если выполнились условия пишем соответствующие сообщения и в переменную win присваеваем 1.

+ if win == 1:
    + return

Если в переменной win лежит 1 значит игра окончина и прирываем основной цикл

+ if prov == 0:
    + while True:
        + answer = int(randint(1, 9))
        + if(str(board[answer-1]) not in "XO"):
            + board[answer-1] = 'O'
            + bot.send_message(message.chat.id,"ИИ сделал ход")
            + break

Если в переменной prov лежит 1 значит игрок допустил ошибку и пропускаем этот цикл. Иначе запускаем его. Тут делает ход программа. Присваеваем переменной answer случайное число от 1 до 9. проверяем не занята ли эта клетка. Если она свободна делается ход выводится сообщение и прирывается цикл. Если клетка занята то зпново запускается цикл.

+ if prov == 0:
    + for i in range(3):
        + bot.send_message(message.chat.id, (f'| {board[0+i*3]} | {board[1+i*3]} | {board[2+i*3]} |'))

Проверяем небыло ли ошибок от игрока если небыло выводим доску сообщениями.

+ for each in win_coord:
    + if board[each[0]] == board[each[1]] == board[each[2]]:
        + bot.send_message(message.chat.id,"Игра закончилась, победил ИИ")

Проверяем не закончилась ли игра. Если условия не выполнились программа продолжет дальше работать. А если выполнились условия пишем соответствующие сообщение.



## Работа с ботом ##

Пишем /start
нам появляестя игровая доска<br/>
![pic1](start.jpg)

Пишем /hod 5
Мы сделали ход и поставили X п воле 5<br/>
![pic2](hod.jpg)

И так пока не ваеграт кто нибуть<br/>

![pic3](hod1.jpg)